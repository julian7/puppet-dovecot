log_timestamp = "%Y-%m-%d %H:%M:%S "
mail_max_userip_connections = 40
mail_privileged_group = mail
<%- if @sql -%>
# Auth from SQL
passdb {
  driver = sql
  args = /etc/dovecot/dovecot-sql.conf
}
userdb {
  driver = static
  args = uid=<%= @virtual_uid %> gid=<%= @virtual_gid %> home=<%= @virtual_homes %>/%d/%u/
}
<%- end -%>
<%- if @pam -%>
# Auth from local password database
passdb {
  driver = pam
}
userdb {
  driver = passwd
}
<%- end -%>
protocols = imap pop3
<%- if @sasl -%>
# SASL service for Postfix
service auth {
  unix_listener /var/spool/postfix/private/auth {
    group = postfix
    mode = 0660
    user = postfix
  }
  user = root
}
<%- end -%>
<%- if @ssl -%>
# SSL setup
ssl_cert = </etc/ssl/certs/<%= @ssl %>.pem
ssl_key = </etc/ssl/private/<%= @ssl %>.pem
<%- end -%>
